<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "Http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="account.dao.AccountDAO">
	  <insert id="insert" parameterType="accountVO">
      	insert into S_ACCOUNT(accountNo,ID, BANK_NAME, ACCOUNT_NUM, BALANCE,NICK_NAME,type)
      	values( seq_S_ACCOUNT_no.nextval ,#{id}, #{bank_name}, #{account_num}, #{balance},#{nick_name},#{type})
    </insert> 
    
    <!--  원화계좌 모두 조회 -->
    <select id="selectKrwAll" resultType="accountVO" parameterType="string" >
    	select * from S_ACCOUNT where id = #{id} and type='K'
    </select>
    
    <!--  외화계좌 모두 조회 -->
    <select id="selectCurAll" resultType="accountVO" parameterType="string" >
      select * from S_ACCOUNT where id = #{id} and type='C'
    </select>
    
    <!-- 계좌이체 출금 -->
    <update id="transfer1" parameterType="accountVO" >
    	update S_ACCOUNT set balance = balance - #{balance}
    	where account_num=#{account_num}
    </update>
    
    <!-- 계좌이체 입금 -->
    <update id="transfer2" parameterType="accountVO" >
    	update S_ACCOUNT set balance = balance + #{balance}
    	where account_num=#{bank_name}
    </update>
    
    <!-- 환전하기 기능. 원화계좌에서 환전시 필요한만큼의 돈 빼기! -->
    <update id="doExchange" parameterType="exchangeVO">
      update S_ACCOUNT set balance = balance - #{exchangecharge} where account_num=#{account_num}
    </update>
    
    <!-- 환전하기에서 외화계좌에 환전하려는 통화와 관련된 record있는지 확인 -->
    <select id="chkCur" parameterType="exchangeVO" resultType="string">
      select ACCOUNT_NUM from s_account where id =#{id} and type='C'
    </select>
    
    
    <!-- 환전하기 기능에서 외화계좌에 돈 insert -->
<!--     <insert id="doExchangeCurInsert" parameterType="exchangeVO">
      
    </insert> -->
    
    <!-- 환전하기 기능에서 외화계좌에 돈 update -->
<!--     <update id="">
      
    </update> -->
    
    
    <!-- 계좌비밀번호 확인. 리턴값 잔액 -->
    <select id="chkPassword" parameterType="accountVO" resultType="int">
      select count(*) from S_ACCOUNT where account_num = #{account_num} and bank_name =#{bank_name}
    </select>
    
</mapper>